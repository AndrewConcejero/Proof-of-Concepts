<?xml version="1.0" ?><cherrytree><node custom_icon_id="0" foreground="" is_bold="True" name="BP-6002-004-2019" prog_lang="custom-colors" readonly="False" tags="" ts_creation="1562128636.96" ts_lastsave="1564054455.43" unique_id="75"><rich_text scale="h3" weight="heavy">Title:</rich_text><rich_text scale="h3"> Usage of BITS (Background Intelligent Transfer Service) to manage files</rich_text><rich_text>

</rich_text><rich_text scale="h3" weight="heavy">Description:</rich_text><rich_text scale="h3"> This section will cover the usage of BITs in both powershell and cmd to manage files over a created local user using python (see </rich_text><rich_text link="node 25" scale="h3">Download FIle</rich_text><rich_text scale="h3">)</rich_text><rich_text>

</rich_text><rich_text scale="h3" weight="heavy">ATT&amp;CK Tactic and Technique:</rich_text><rich_text scale="h3"> </rich_text><rich_text link="webs https://attack.mitre.org/techniques/T1197/">https://attack.mitre.org/techniques/T1197/</rich_text><rich_text>
</rich_text><rich_text scale="h3" weight="heavy">Use Case ID(s) and Description(s):</rich_text><rich_text scale="h3"> </rich_text><rich_text link="webs https://jpcertcc.github.io/ToolAnalysisResultSheet/">https://jpcertcc.github.io/ToolAnalysisResultSheet/</rich_text><rich_text>

</rich_text><rich_text scale="h3" weight="heavy">Prerequisites: </rich_text><rich_text>
    
    1. Bitsadmin and Start-bitstransfer is installed in powershell
    
    2. A local server will be set up using python (see </rich_text><rich_text link="node 25">DownloadFile</rich_text><rich_text> prerequisites)
    
    3. Advance audit policies and </rich_text><rich_text link="node 24">Sysmon</rich_text><rich_text> are enabled

</rich_text><rich_text scale="h3" weight="heavy">Steps to Reproduce and Verify:</rich_text><rich_text>

    1. </rich_text><rich_text link="node 76">Bitsadmin</rich_text><rich_text>
    
    2. </rich_text><rich_text link="node 77">Start-BitsTransfer</rich_text><rich_text>

</rich_text><rich_text scale="h3" weight="heavy">References:</rich_text><rich_text>
</rich_text><rich_text link="webs https://ss64.com/nt/bitsadmin.html">https://ss64.com/nt/bitsadmin.html</rich_text><rich_text>
</rich_text><rich_text link="webs https://docs.microsoft.com/en-us/powershell/module/bitstransfer/start-bitstransfer?view=win10-ps">https://docs.microsoft.com/en-us/powershell/module/bitstransfer/start-bitstransfer?view=win10-ps</rich_text><rich_text>
</rich_text><rich_text link="webs https://mcpmag.com/articles/2017/08/03/leverage-bits-for-file-transfers-with-powershell.aspx">https://mcpmag.com/articles/2017/08/03/leverage-bits-for-file-transfers-with-powershell.aspx</rich_text><rich_text>
</rich_text><rich_text link="webs https://docs.microsoft.com/en-us/windows/desktop/bits/using-windows-powershell-to-create-bits-transfer-jobs">https://docs.microsoft.com/en-us/windows/desktop/bits/using-windows-powershell-to-create-bits-transfer-jobs</rich_text><rich_text>
</rich_text><rich_text link="webs https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin-examples">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin-examples</rich_text></node></cherrytree>